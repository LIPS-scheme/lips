<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-scheme-intro/macros" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.0">
<title data-rh="true">Macros | LIPS Scheme</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lips.js.org/img/lips-social-card.png"><meta data-rh="true" name="twitter:image" content="https://lips.js.org/img/lips-social-card.png"><meta data-rh="true" property="og:url" content="https://lips.js.org/docs/scheme-intro/macros"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Macros | LIPS Scheme"><meta data-rh="true" name="description" content="Macros are the most powerful feature of Lisp and Scheme"><meta data-rh="true" property="og:description" content="Macros are the most powerful feature of Lisp and Scheme"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lips.js.org/docs/scheme-intro/macros"><link data-rh="true" rel="alternate" href="https://lips.js.org/docs/scheme-intro/macros" hreflang="en"><link data-rh="true" rel="alternate" href="https://lips.js.org/docs/scheme-intro/macros" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://HSV6UC2UY5-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="LIPS Scheme blog RSS Feed"><link rel="stylesheet" href="/assets/css/styles.666652d4.css">
<script src="/assets/js/runtime~main.7ca5136c.js" defer="defer"></script>
<script src="/assets/js/main.ad626811.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo-black.svg" alt="LIPS Scheme Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-white.svg" alt="LIPS Scheme Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Scheme</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/reference">Reference</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://twitter.com/LIPS_scheme" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter/X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://gitter.im/jcubic/lips" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/LIPS-scheme/lips" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/introduction-to-scheme">Introduction to Scheme</a><button aria-label="Collapse sidebar category &#x27;Introduction to Scheme&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scheme-intro/what-is-lisp">What is Lisp and Scheme?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scheme-intro/data-types">Data Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scheme-intro/core">Core of Scheme</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scheme-intro/input-output">Input and Output</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/scheme-intro/macros">Macros</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scheme-intro/streams">Streams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scheme-intro/continuations">Continuations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scheme-intro/next-step">What Next?</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/lips-introduction">LIPS introduction</a><button aria-label="Expand sidebar category &#x27;LIPS introduction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/introduction-to-scheme"><span itemprop="name">Introduction to Scheme</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Macros</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Macros</h1></header>
<p>Macros are the most powerful feature of the language (both lisp and Scheme).  Macros allows you to add
new syntax to the language, it also allows making simpler code and reduce
<a href="https://en.wikipedia.org/wiki/Boilerplate_code" target="_blank" rel="noopener noreferrer">boilerplate</a>.</p>
<p>Macros works like a function, but the arguments of the macro are not evaluated before passing the
value to the function. But instead the code of the arguments are passed to the macro, the macro then
can manipulate the code and return new code that is then evaluated. This happens during expansion
time before evaluation even happen.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lisp-macros">Lisp Macros<a href="#lisp-macros" class="hash-link" aria-label="Direct link to Lisp Macros" title="Direct link to Lisp Macros">​</a></h2>
<p>Some scheme implementation supports lisp macros, so I will describe them first.</p>
<p>If you have code like this</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And <code>foo</code> is a function, the <code>(+ 1 2)</code> will be evaluated and <code>3</code> will be passed to the function. But if
<code>foo</code> is a macro, the data structure <code>(+ 1 2)</code> will be passed to the macro.</p>
<p>To define a macro, you use usually use <code>define-macro</code> syntax. Lisp macros in Scheme are not standard,
so the syntax may change depending on
<a href="/docs/scheme-intro/what-is-lisp#scheme-implementations">Scheme implementation</a>.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> </span><span class="token name">expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">car</span><span class="token plain"> </span><span class="token name">expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set-car!</span><span class="token plain"> </span><span class="token name">expr</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;-</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set-car!</span><span class="token plain"> </span><span class="token name">expr</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;+</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token name">expr</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This macro swap first element of the expression passed as argument. If you pass sum of two numbers
It will subtract the values:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; -1</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>if you use minus symbol it will add up the numbers:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 3</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Instead of modification of existing code you can also create new list:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> </span><span class="token name">expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">list</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">car</span><span class="token plain"> </span><span class="token name">expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;-</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;+</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cadr</span><span class="token plain"> </span><span class="token name">expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">caddr</span><span class="token plain"> </span><span class="token name">expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It will work similarly but only with two numbers:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 3</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; -1</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="macroexpand">Macroexpand<a href="#macroexpand" class="hash-link" aria-label="Direct link to Macroexpand" title="Direct link to Macroexpand">​</a></h3>
<p>Some scheme implementation have function <code>macroexpand</code> that allow to inspect the result expression
returned by the macro.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">macroexpand</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; (- 1 2)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Macros can be nested, so one expression can expand into something you don&#x27;t expect to see. For this
you have a function called <code>macroexpand-1</code> that should expand macro one time. Which in turn should
expand just your macro.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Before you read the next section, it&#x27;s recommended to read about <a href="/docs/scheme-intro/data-types#quasiquote">quasiquote syntax</a> first.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-control-flow-constructs">New Control Flow Constructs<a href="#new-control-flow-constructs" class="hash-link" aria-label="Direct link to New Control Flow Constructs" title="Direct link to New Control Flow Constructs">​</a></h3>
<p>With macros, you can define new control flow (e.g. like <code>if</code> statements). Here is an example of
<code>when</code> macro that is part of R7RS standard.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> </span><span class="token name">test</span><span class="token plain"> . </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  `</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">if</span><span class="token plain"> </span><span class="token name">,test</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token name">,@body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">x</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">zero?</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; = &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;zero&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; x = zero</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you probably already know to use multiple expressions in
<a href="/docs/scheme-intro/core#conditionals">if statement</a> you need to use <code>begin</code>. The macro use
<a href="/docs/scheme-intro/data-types#quasiquote">quasiquote syntax</a>.</p>
<p>You can use <code>macroexpand</code> to see what will be the output of the expression:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">macroexpand</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">x</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">zero?</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;zero&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; (let ((x 0))</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt;   (if (zero? x)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt;       (begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt;         (display &quot;zero&quot;)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt;         (newline))))</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gensyms">Gensyms<a href="#gensyms" class="hash-link" aria-label="Direct link to Gensyms" title="Direct link to Gensyms">​</a></h3>
<p>If you create lisp macros you often may end up with expansion and user code to collide and use the
same variables. You call this accidental capture of identifiers.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> </span><span class="token name">expr</span><span class="token plain"> </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  `</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tmp</span><span class="token plain"> </span><span class="token name">,expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token name">tmp</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token name">,@body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you define macro like this the user of your macro may want to use <code>tmp</code> variable and the code
will give unexpected behavior:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tmp</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token name">tmp</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token name">tmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; #t</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will print <code>#t</code> but you expect it to print <code>1000</code>. This problem can be solved with special kind
of symbols called <code>gensyms</code>. Each gensym is a unique symbol.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> </span><span class="token name">expr</span><span class="token plain"> </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tmp</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">gensym</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    `</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">,tmp</span><span class="token plain"> </span><span class="token name">,expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token name">,tmp</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token name">,@body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice that let that call <code>gensym</code> is outside quasiquote so it will be evaluated when macro is
executed by the output code will have a unique symbol instead of hard coded symbol <code>tmp</code>.</p>
<p>If you try to evaluate the macro, you will get proper results:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tmp</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token name">tmp</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token name">tmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 1000</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recursive-macros">Recursive Macros<a href="#recursive-macros" class="hash-link" aria-label="Direct link to Recursive Macros" title="Direct link to Recursive Macros">​</a></h3>
<p>You can define recursive macros similarly to recursive function. But you need to make sure that the
expansion will stop, similarly to recursive functions you may create infinite loops.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> . </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">null?</span><span class="token plain"> </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      `</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">cons</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cons</span><span class="token plain"> ,</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">car</span><span class="token plain"> </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ,</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cadr</span><span class="token plain"> </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> </span><span class="token name">,@</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cddr</span><span class="token plain"> </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can call this macro to create alist based on its arguments:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;baz&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; ((&quot;foo&quot; . 10) (&quot;bar&quot; . 20) (&quot;baz&quot; . 30))</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note</strong> recursive call is inside quote and only argument is unquoted. This is required since
recursive macro call needs to appear in the expansion. If you call macro recursively and don&#x27;t return
macro call as output list you will end up in ifninite recursive call.</p>
<p>You can see the macro will expand with macroexpand:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">macroexpand</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;baz&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; (cons (cons &quot;foo&quot; 10) (cons (cons &quot;bar&quot; 20) (cons (cons &quot;baz&quot; 30) ())))</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="anaphoric-macros">Anaphoric Macros<a href="#anaphoric-macros" class="hash-link" aria-label="Direct link to Anaphoric Macros" title="Direct link to Anaphoric Macros">​</a></h3>
<p>Anaphoric macros are special kind of macros that leverage the leaking of internal data outside
the macro. This is called intentional capture of identifiers. They often expose one or more variable
that can be used by the users of the macro.</p>
<p>Example of such macro is <code>aif</code>:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">aif</span><span class="token plain"> </span><span class="token name">test</span><span class="token plain"> </span><span class="token name">true</span><span class="token plain"> </span><span class="token name">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  `</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">it</span><span class="token plain"> </span><span class="token name">,test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token name">it</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token name">,true</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token name">,false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This macro uses <code>it</code> variable to hold the testing value that can be used inside user code:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">a</span><span class="token plain"> . </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">b</span><span class="token plain"> . </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">c</span><span class="token plain"> . </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">aif</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">assoc</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;a</span><span class="token plain"> </span><span class="token name">alist</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cdr</span><span class="token plain"> </span><span class="token name">it</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 10</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you only have one branch like in above code you can define <code>awhen</code> macro:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">awhen</span><span class="token plain"> </span><span class="token name">test</span><span class="token plain"> . </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  `</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">it</span><span class="token plain"> </span><span class="token name">,test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token name">it</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token name">,@body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">a</span><span class="token plain"> . </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">b</span><span class="token plain"> . </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">c</span><span class="token plain"> . </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">awhen</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">assoc</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;a</span><span class="token plain"> </span><span class="token name">alist</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cdr</span><span class="token plain"> </span><span class="token name">it</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 10</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scheme-hygienic-macros">Scheme Hygienic Macros<a href="#scheme-hygienic-macros" class="hash-link" aria-label="Direct link to Scheme Hygienic Macros" title="Direct link to Scheme Hygienic Macros">​</a></h2>
<p>The problem with Lisp macros is that they are not hygienic. But what it means?</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hygiene">Hygiene<a href="#hygiene" class="hash-link" aria-label="Direct link to Hygiene" title="Direct link to Hygiene">​</a></h3>
<p>If macro is hygienic, it means that it guaranty no leaking of internal code outside of macro. In
other words guaranteed not to cause the accidental capture of identifiers. Scheme standard define
new macro system called <code>syntax-rules</code> that is hygienic.</p>
<p>But we have <code>gensym</code> is this not enough to make the macros safe? No</p>
<p>Here is an example implementation of <code>unless</code> macro that is part of Scheme that fails because it&#x27;s
not hygienic.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-macro</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unless</span><span class="token plain"> </span><span class="token name">test</span><span class="token plain"> . </span><span class="token name">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  `</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">not</span><span class="token plain"> </span><span class="token name">,test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token name">,@body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>But in Scheme you can define a variable named not and completely break the macro:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">not</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token lambda-parameter">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unless</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">#f</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;this should not run&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; this should not run</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will print the expression because the unless macro uses not procedure that got overwritten by the
user code. Hygiene of macros means that something like this can&#x27;t happen.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="syntax-rules">Syntax-rules<a href="#syntax-rules" class="hash-link" aria-label="Direct link to Syntax-rules" title="Direct link to Syntax-rules">​</a></h3>
<p>The <code>syntax-rules</code> in Scheme is different type of macros than lisp macros. It uses a special pattern
matching language. Syntax-rules is guarantee by the sec to be hygienic.</p>
<p>Here is the simple definition of a hygienic macro in Scheme:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">unless</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token name">test</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">not</span><span class="token plain"> </span><span class="token name">test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This macro is hygienic. If you use same test as before:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">not</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token lambda-parameter">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unless</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">#t</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;this should not run&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It will not print any value.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="syntax-rules-pattern-language">Syntax-rules pattern language<a href="#syntax-rules-pattern-language" class="hash-link" aria-label="Direct link to Syntax-rules pattern language" title="Direct link to Syntax-rules pattern language">​</a></h3>
<p>Syntax rules macro is defined like this:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">foo</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">name</span><span class="token plain"> </span><span class="token name">&lt;pattern&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">&lt;expansion&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">name</span><span class="token plain"> </span><span class="token name">&lt;different</span><span class="token plain"> </span><span class="token name">pattern&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">&lt;different</span><span class="token plain"> </span><span class="token name">expansion&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The first element if the macro is a list of identifiers that can be used in the pattern.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">for</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">in</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">for</span><span class="token plain"> </span><span class="token name">element</span><span class="token plain"> </span><span class="token name">in</span><span class="token plain"> </span><span class="token name">list</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">for-each</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token lambda-parameter">element</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token name">list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is an example of a <code>for</code> macro that have <code>in</code> special keyword inside the parentheses. This
macro can be used like this:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">for</span><span class="token plain"> i </span><span class="token name">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 1</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 2</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 3</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 4</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you try to overwrite the <code>in</code> symbol with variable:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">in</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">#t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">for</span><span class="token plain"> i </span><span class="token name">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; syntax-rules: no matching syntax in macro</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You will get an error because in is no longer a special identifier. It&#x27;s now a variable.</p>
<p>The rest are the list of pattern and expansion. You can build a shape of the code your macro accept
and use part of the pattern in output macro.</p>
<p>the first element of the pattern is often <code>_</code> it matches against the name of the macro.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ellipsis">Ellipsis<a href="#ellipsis" class="hash-link" aria-label="Direct link to Ellipsis" title="Direct link to Ellipsis">​</a></h3>
<p>In lisp macros if you wanted to define a list of any values (including no values) you use
<a href="/docs/scheme-intro/data-types#improper-list">improper list</a> (list with dot). In syntax-rules
pattern you use an ellipsis to indicate a list of items. The ellipsis is after the symbol.</p>
<p>Example of usage of ellipsis:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">values</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">a</span><span class="token plain"> . b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This macro use an alist as a pattern and only return the values. Note that it doesn&#x27;t work on a
variable that hold the alist only for alist defined inside the code:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">values</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> . </span><span class="token string" style="color:#e3116c">&quot;lorem&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">bar</span><span class="token plain"> . </span><span class="token string" style="color:#e3116c">&quot;ipsum&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">baz</span><span class="token plain"> . </span><span class="token string" style="color:#e3116c">&quot;dolor&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; (foo bar baz)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nested-hygienic-macros">Nested Hygienic Macros<a href="#nested-hygienic-macros" class="hash-link" aria-label="Direct link to Nested Hygienic Macros" title="Direct link to Nested Hygienic Macros">​</a></h3>
<p>There are two ways to defined nested macros, macros that define macros. One is escape of ellipsis
with <code>(... ...)</code> syntax.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">define-for</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token name">symbol</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">symbol</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">...</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token name">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token name">var</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token name">body</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">...</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token name">var</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This macro defines macros that act like for loop, but using tail recursive, named let. You can use this macro like this:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">define-for</span><span class="token plain"> </span><span class="token name">loop</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">i</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> i </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 1 2 3 4 5 6 7 8 9 10</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Another way to define nested marcros is using
<a href="https://srfi.schemers.org/srfi-46/srfi-46.html" target="_blank" rel="noopener noreferrer">SRFI-46</a> syntax, which allow to change the symbol of ellipsis:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">define-for</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token name">symbol</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">symbol</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">:::</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">:::)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token name">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token name">var</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token name">body</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">:::</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token name">var</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The macro works exactly the same as previous one:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">define-for</span><span class="token plain"> </span><span class="token name">loop</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">i</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> i </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 1 2 3 4 5 6 7 8 9 10</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="identifiers">Identifiers<a href="#identifiers" class="hash-link" aria-label="Direct link to Identifiers" title="Direct link to Identifiers">​</a></h3>
<p>Inside macros you can add identifiers can can be used like keywords from other programming languages. They match only
if literal symbol was used and it was not shadowed (overwritten) by variable with same name.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">for</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">==&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token plain"> </span><span class="token name">==&gt;</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token name">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token name">var</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token name">var</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This for macro define symbol <code>==&gt;</code> that can be used as part of the syntax:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">start</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">end</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">i</span><span class="token plain"> </span><span class="token name">start</span><span class="token plain"> </span><span class="token name">==&gt;</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> i </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; 1 2 3 4 5 6 7 8 9 10</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the symbol <code>==&gt;</code> is shadowed by local variable the macro will not match and give an error:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">start</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">end</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">==&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;this will not work&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">i</span><span class="token plain"> </span><span class="token name">start</span><span class="token plain"> </span><span class="token name">==&gt;</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> i </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">display</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; syntax-rules: no matching syntax in macro</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>special keywords (created with identifiers) can be optional:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">for</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">==&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token plain"> </span><span class="token name">==&gt;</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token plain"> </span><span class="token name">==&gt;</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token name">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">var</span><span class="token plain"> </span><span class="token name">start</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token name">var</span><span class="token plain"> </span><span class="token name">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token name">var</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is recursive <code>syntax-rules</code> that when using without <code>==&gt;</code> symbol it just add it between <code>start</code>
and <code>end</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recursive-hygienic-macros">Recursive Hygienic Macros<a href="#recursive-hygienic-macros" class="hash-link" aria-label="Direct link to Recursive Hygienic Macros" title="Direct link to Recursive Hygienic Macros">​</a></h3>
<p>You can define recursive hygienic macros, similar to recursive function you need a base case that will stop expansion and
recursve case.</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">alist</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> x y z </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cons</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cons</span><span class="token plain"> x y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> z </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here is example of recursive macro that expand into series of <code>cons</code>. You can use this macro like this:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;foo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;bar</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;baz</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; ((foo . 10) (bar . 20) (baz . 30))</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the Scheme interpreter of choice support macroexpand on hygienic macros you will see that it
expact into series of <code>cons</code>:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">macroexpand</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token name">alist</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;foo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;bar</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;baz</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; (#:cons (#:cons (quote foo) 10) (#:cons (#:cons (quote bar) 20) (#:cons (#:cons (quote baz) 30) ())))</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output may be different depending on implementation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="anaphoric-hygienic-macros">Anaphoric Hygienic Macros<a href="#anaphoric-hygienic-macros" class="hash-link" aria-label="Direct link to Anaphoric Hygienic Macros" title="Direct link to Anaphoric Hygienic Macros">​</a></h3>
<p>By default Scheme <code>syntax-rules</code> macros don&#x27;t allow creating anaphoric macros like lisp macro do.
But with <a href="https://srfi.schemers.org/srfi-139/srfi-139.html" target="_blank" rel="noopener noreferrer">SRFI-139</a> you can implement such macros.</p>
<p><strong>Note</strong>: that not every scheme implementation support this <abbr title="Scheme Request For
Implementation">SRFI</abbr>.</p>
<p>Here is example of <code>awhen</code> anaphoric macro that use this <abbr title="Scheme Request For
Implementation">SRFI</abbr>:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">define-syntax-parameter</span><span class="token plain"> </span><span class="token name">it</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">syntax-error</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Use outside aif&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">define-syntax</span><span class="token plain"> </span><span class="token name">awhen</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token plain"> </span><span class="token name">test</span><span class="token plain"> </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tmp</span><span class="token plain"> </span><span class="token name">test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">syntax-parameterize</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">it</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">syntax-rules</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token name">tmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token name">tmp</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token name">body</span><span class="token plain"> </span><span class="token name">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>syntax-paremetirize</code> works similar to
<a href="/docs/scheme-intro/core#dynamic-variables">parameters from R<sup>7</sup>RS</a>.</p>
<p>You can use this macro like this:</p>
<div><div><pre tabindex="0"><code><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">alist</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">foo</span><span class="token plain"> . </span><span class="token string" style="color:#e3116c">&quot;lorem&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">bar</span><span class="token plain"> . </span><span class="token string" style="color:#e3116c">&quot;ipsum&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">baz</span><span class="token plain"> . </span><span class="token string" style="color:#e3116c">&quot;dolor&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">awhen</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">assoc</span><span class="token plain"> </span><span class="token symbol" style="color:#36acaa">&#x27;bar</span><span class="token plain"> </span><span class="token name">alist</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">write</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">cdr</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">it</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">newline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span>
</span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">;; ==&gt; &quot;ipsum&quot;</span>
</span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note the difference, the parameter needs to be wrapped by parentheses like a procedure/macro call.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/LIPS-scheme/lips/tree/master/docs/docs/scheme-intro/macros.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/scheme-intro/input-output"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Input and Output</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/scheme-intro/streams"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Streams</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#lisp-macros" class="table-of-contents__link toc-highlight">Lisp Macros</a><ul><li><a href="#macroexpand" class="table-of-contents__link toc-highlight">Macroexpand</a></li><li><a href="#new-control-flow-constructs" class="table-of-contents__link toc-highlight">New Control Flow Constructs</a></li><li><a href="#gensyms" class="table-of-contents__link toc-highlight">Gensyms</a></li><li><a href="#recursive-macros" class="table-of-contents__link toc-highlight">Recursive Macros</a></li><li><a href="#anaphoric-macros" class="table-of-contents__link toc-highlight">Anaphoric Macros</a></li></ul></li><li><a href="#scheme-hygienic-macros" class="table-of-contents__link toc-highlight">Scheme Hygienic Macros</a><ul><li><a href="#hygiene" class="table-of-contents__link toc-highlight">Hygiene</a></li><li><a href="#syntax-rules" class="table-of-contents__link toc-highlight">Syntax-rules</a></li><li><a href="#syntax-rules-pattern-language" class="table-of-contents__link toc-highlight">Syntax-rules pattern language</a></li><li><a href="#ellipsis" class="table-of-contents__link toc-highlight">Ellipsis</a></li><li><a href="#nested-hygienic-macros" class="table-of-contents__link toc-highlight">Nested Hygienic Macros</a></li><li><a href="#identifiers" class="table-of-contents__link toc-highlight">Identifiers</a></li><li><a href="#recursive-hygienic-macros" class="table-of-contents__link toc-highlight">Recursive Hygienic Macros</a></li><li><a href="#anaphoric-hygienic-macros" class="table-of-contents__link toc-highlight">Anaphoric Hygienic Macros</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/scheme-intro/what-is-lisp">Introduction to Scheme</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/lips-introduction">LIPS Scheme Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://gitter.im/jcubic/lips" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/LIPS_scheme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/archive">Blog</a></li><li class="footer__item"><a href="https://github.com/LIPS-scheme/lips" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright (c) 2018-2024 <a href="https://jakub.jankiewicz.org">Jakub T. Jankiewicz</a><br>Website content licensed with <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> unless noted otherwise.</div><a href="https://notbyai.fyi" aria-label="Created not by AI"><svg xmlns="http://www.w3.org/2000/svg" width="131" height="42" fill="none" viewBox="0 0 131 42"><path fill="#000" stroke="#ACACAC" d="M.5.5H116c8.008 0 14.5 6.492 14.5 14.5v26.5H15C6.992 41.5.5 35.008.5 27z"></path><path fill="#fff" d="M17.96 24.158a9.446 9.446 0 0 0 11.89 0l-1.34-1.655a7.316 7.316 0 0 1-9.21 0zM19.404 20.513v-2.876h2.13v2.876zM26.012 17.637v2.876h2.13v-2.876z"></path><path fill="#fff" fill-rule="evenodd" d="M35 21.5C35 27.851 29.851 33 23.5 33S12 27.851 12 21.5 17.149 10 23.5 10 35 15.149 35 21.5m-2.13 0a9.37 9.37 0 1 1-18.74 0 9.37 9.37 0 0 1 18.74 0" clip-rule="evenodd"></path><path fill="#fff" d="M48.29 22.178q1.485 0 2.425.79.948.78.949 2.601v6.516h-2.566V26.2q0-.764-.202-1.172-.37-.746-1.406-.746-1.274 0-1.748 1.092-.246.577-.247 1.474v5.237H43v-9.658h2.416v1.411q.484-.745.914-1.074.774-.585 1.96-.586M57.56 30.3q1.099 0 1.688-.79.588-.79.588-2.245t-.588-2.237q-.589-.79-1.688-.79t-1.695.79q-.59.78-.59 2.237 0 1.455.59 2.246.597.79 1.695.79m4.903-3.035q0 2.13-1.212 3.648-1.213 1.51-3.682 1.51t-3.681-1.51q-1.213-1.518-1.213-3.648 0-2.095 1.213-3.631 1.212-1.536 3.681-1.536t3.682 1.536 1.212 3.63M62.56 24.3v-1.802h1.336v-2.699h2.478v2.699h1.556V24.3h-1.556v5.113q0 .595.15.746.15.141.913.142h.238l.255-.018v1.89l-1.187.045q-1.774.063-2.425-.621-.422-.435-.422-1.34V24.3zM77.602 22.196q1.89 0 2.952 1.376 1.072 1.375 1.072 3.55 0 2.256-1.054 3.738t-2.944 1.483q-1.186 0-1.906-.48-.43-.284-.932-.994v1.216H72.34V19.018h2.495v4.651q.474-.675 1.046-1.03.676-.443 1.722-.443m-.641 8.06q.966 0 1.502-.79.537-.79.536-2.077 0-1.03-.263-1.704-.502-1.28-1.846-1.279-1.362 0-1.871 1.252-.264.666-.264 1.722 0 1.243.545 2.06.545.816 1.66.816M83.095 33.94l.316.018a4 4 0 0 0 .703-.026q.334-.045.562-.205.22-.15.404-.63.194-.48.159-.586L81.724 22.41h2.785l2.091 7.137 1.977-7.137h2.663l-3.286 9.516q-.95 2.752-1.503 3.41-.553.665-2.214.665-.334 0-.536-.009-.203 0-.606-.026zM97.783 27.14h3.286l-1.617-5.148zM97.95 19h3.058l4.586 13.085h-2.934l-.835-2.69h-4.771l-.897 2.69h-2.829zM110.59 32.085h-2.688V19h2.688z"></path><path fill="#fff" d="M106.306 19H112v2.226h-5.694zM106.306 29.862H112v2.226h-5.694zM42.975 9.896l1.02 3.97 1.035-3.97h1l1.04 3.947 1.084-3.947h.892l-1.54 5.039h-.926l-1.08-3.9-1.044 3.9h-.926L42 9.896zM49.816 9.896h.846v.87q.105-.253.51-.616a1.35 1.35 0 0 1 1.02-.362l.203.019v.893a1.4 1.4 0 0 0-.292-.023q-.673 0-1.035.414-.36.41-.361.946v2.898h-.891zM53.066 9.92h.906v5.015h-.906zm0-1.896h.906v.96h-.906zM55.4 8.49h.902v1.406h.846v.692h-.846v3.288q0 .263.188.353.104.052.347.052h.138q.075-.005.173-.014v.668q-.154.042-.321.06a3 3 0 0 1-.357.02q-.624 0-.846-.302-.223-.305-.223-.79v-3.335h-.718v-.692h.718zM58.122 8.49h.9v1.406h.847v.692h-.846v3.288q0 .263.188.353.105.052.346.052h.139q.075-.005.173-.014v.668q-.154.042-.322.06a3 3 0 0 1-.356.02q-.624 0-.847-.302-.222-.305-.223-.79v-3.335h-.717v-.692h.717zM62.872 9.783q.565 0 1.095.254.53.25.807.65.267.38.356.889.08.348.08 1.11h-3.887q.024.767.38 1.233.357.46 1.105.46.698 0 1.114-.437.237-.254.337-.588h.876q-.034.278-.233.62-.193.34-.435.556-.407.376-1.005.508a3.2 3.2 0 0 1-.728.075q-.99 0-1.679-.682-.688-.686-.688-1.92 0-1.212.693-1.97t1.812-.758m1.421 2.23q-.054-.55-.252-.88-.366-.61-1.223-.611-.615 0-1.03.423-.416.42-.44 1.068zM66.207 9.896h.847v.715q.375-.443.797-.635a2.2 2.2 0 0 1 .936-.193q1.128 0 1.525.748.218.409.218 1.172v3.232h-.907v-3.176q0-.46-.143-.743-.238-.47-.862-.47-.315 0-.52.06a1.34 1.34 0 0 0-.643.414 1.25 1.25 0 0 0-.292.518 3.4 3.4 0 0 0-.065.757v2.64h-.89zM74.402 8h.866v2.508q.292-.363.698-.55.406-.195.881-.194.99 0 1.605.65.618.644.618 1.905 0 1.195-.608 1.985-.61.79-1.689.79-.603 0-1.02-.277-.247-.164-.53-.527v.645h-.822zm2.317 6.347q.722 0 1.08-.546.36-.546.36-1.44 0-.795-.36-1.317-.358-.522-1.056-.522-.608 0-1.069.428-.456.428-.456 1.411 0 .71.189 1.153.35.833 1.312.833M83.326 9.896h.986q-.189.485-.837 2.211-.485 1.3-.812 2.117-.772 1.929-1.09 2.353-.316.423-1.089.423-.188 0-.292-.014a3 3 0 0 1-.247-.052v-.771q.232.06.336.075t.183.014q.248 0 .362-.08a.7.7 0 0 0 .198-.188q.025-.038.178-.386.154-.348.223-.518l-1.96-5.184h1.01l1.42 4.102zM87.703 8h.891v2.578q.318-.381.57-.536.43-.268 1.074-.268 1.154 0 1.565.767.222.418.223 1.162v3.232h-.916v-3.176q0-.555-.149-.814-.243-.414-.91-.414-.556 0-1.006.362-.45.363-.45 1.37v2.672h-.892zM94.138 9.896v3.345q0 .386.128.63.238.452.886.452.931 0 1.268-.79.183-.424.183-1.162V9.896h.891v5.039h-.841l.01-.744q-.174.288-.431.485-.51.395-1.238.395-1.133 0-1.545-.72-.222-.385-.222-1.03V9.896zM98.79 9.896h.88v.715q.318-.372.575-.541a1.8 1.8 0 0 1 1-.287q.635 0 1.02.297.218.169.396.498.297-.405.698-.597.402-.198.901-.198 1.07 0 1.456.734.208.395.208 1.063v3.355h-.926v-3.5q0-.504-.267-.692a1.08 1.08 0 0 0-.644-.188q-.525 0-.906.334-.376.333-.376 1.115v2.93h-.906v-3.288q0-.513-.129-.748-.203-.353-.758-.353-.504 0-.921.372-.41.372-.41 1.345v2.673h-.892zM107.818 13.594q0 .367.282.579.282.21.669.211.47 0 .911-.207.742-.344.742-1.124v-.682q-.163.099-.421.164-.257.066-.505.094l-.539.066q-.485.061-.728.193-.411.222-.411.706m2.159-1.713q.306-.037.411-.244a.7.7 0 0 0 .059-.325q0-.432-.327-.626-.321-.197-.926-.197-.698 0-.99.357-.164.198-.213.588h-.832q.025-.93.634-1.293.614-.367 1.421-.367.936 0 1.52.338.579.34.579 1.054v2.903q0 .131.055.212.06.08.243.08.059 0 .133-.005l.159-.024v.626a3 3 0 0 1-.317.07q-.11.015-.297.015-.46 0-.669-.31a1.2 1.2 0 0 1-.153-.466q-.273.337-.783.588-.509.249-1.123.249-.738 0-1.209-.423a1.4 1.4 0 0 1-.465-1.068q0-.702.461-1.087.46-.386 1.208-.475zM112.678 9.896h.846v.715q.377-.443.797-.635.422-.193.936-.193 1.13 0 1.525.748.218.409.218 1.172v3.232h-.906v-3.176q0-.46-.144-.743-.237-.47-.861-.47-.317 0-.52.06a1.35 1.35 0 0 0-.644.414 1.25 1.25 0 0 0-.292.518q-.064.263-.064.757v2.64h-.891z"></path></svg></a></div></div><script defer="" src="https://api.feedbhack.com/assets/app.js" website-id="6703059dee359a44f772ff78"></script><script>var owa_baseUrl="https://stats.jcubic.pl/",owa_cmds=owa_cmds||[];owa_cmds.push(["setSiteId","922150e605063a8580e17047ffbf3ec2"]),owa_cmds.push(["trackPageView"]),owa_cmds.push(["trackClicks"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,owa_baseUrl="https:"==document.location.protocol?window.owa_baseSecUrl||owa_baseUrl.replace(/http:/,"https:"):owa_baseUrl,e.src=owa_baseUrl+"modules/base/js/owa.tracker-combined-min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(e,a)}()</script><script>var _paq=_paq||[];_paq.push(["setTrackingSource","jstc_tm"]),_paq.push(["enableLinkTracking"]),_paq.push(["setIpTracking",!0]),_paq.push(["setDomains",["lips.js.org"]]),_paq.push(["trackPageView"]),_paq.push(["enableJSErrorTracking"]),function(p,e,a,s){var t=s.createElement("script"),r=s.getElementsByTagName("script")[0];_paq.push(["setTrackerUrl","https://jcubic.piwik.pro/ppms.php"]),_paq.push(["setSiteId","018719ec-6793-4a2d-92f9-b8b88a01d43c"]),t.type="text/javascript",t.async=!0,t.defer=!0,t.src="https://jcubic.containers.piwik.pro/ppms.js",r.parentNode.insertBefore(t,r)}(0,0,0,document)</script></footer></div>
</body>
</html>