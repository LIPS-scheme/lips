<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>LIPS - Documentation</title>
    <meta name="Description" content="Documentation for LISP - Scheme based LISP in JavaScript"/>
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png"/>
    <link rel="manifest" href="favicon/site.webmanifest"/>
    <link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#5bbad5"/>
    <link rel="shortcut icon" href="favicon/favicon.ico"/>
    <meta name="msapplication-TileColor" content="#ff6600"/>
    <meta name="msapplication-config" content="favicon/browserconfig.xml"/>
    <meta name="theme-color" content="#ffffff"/>
    <!--[if IE]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://cdn.jsdelivr.net/combine/npm/jquery.terminal/css/jquery.terminal.min.css,npm/terminal-prism/css/prism-coy.css" rel="stylesheet"/>
    <link href="./examples/common.css" rel="stylesheet"/>
    <link href="style.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Crimson+Text|Play" rel="stylesheet"/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="LIPS Is Pretty Simple"/>
    <meta property="og:description" content="Powerful Scheme based lisp in JavaScript"/>
    <meta property="og:url" content="https://jcubic.github.io/lips/"/>
    <meta property="og:site_name" content="lips"/>
    <meta property="og:image" content="https://jcubic.github.io/lips/banner.png"/>

    <meta name="twitter:image" content="https://jcubic.github.io/lips/banner.png"/>
    <meta name="twitter:image:alt" content="Logo and text 'LIPS Is Pretty Simple'"/>
    <meta name="twitter:title" content="LIPS Is Pretty Simple"/>
    <meta name="twitter:description" content="Powerful Scheme based lisp in JavaScript"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@jcubic"/>
    <meta name="twitter:creator" content="@jcubic"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body>
  <header class="main">
    <a href="/" title="LIPS Home Page">
      <img src="logo.svg" alt="LIPS Logo: Scheme (lisp dialect) in JavaScript"/>
      <h1>
        Powerful Scheme lisp in JavaScript
      </h1>
    </a>
    <nav>
      <ul>
        <li><a href="/#demo">Demo</a></li>
        <li><a href="/docs.html">Docs</a></li>
        <li><a href="https://github.com/jcubic/lips/wiki/Getting-Started">Getting Started</a></li>
        <li><a href="https://github.com/jcubic/lips">source</a></li>
        <li><a href="/examples/index.html">Hyper App</a></li>
        <li><a href="/todo.html#/all">TODO app</a></li>
        <li><a href="https://gitter.im/jcubic/lips">Chat</a></li>
      </ul>
    </nav>
  </header>
  <a href="https://github.com/jcubic/lips" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

  <section>
    <h3>Variables and functions</h3>

    <pre><code class="language-scheme">
(define x 10)
(define square (lambda (x) (* x x)))
(define (square x) (* x x))
    </code></pre>

    <h3>Lisp Macros</h3>

    <pre><code class="language-scheme">
(define-macro (foo x) `(1 2 ,@(car x) 3 4))
    </code></pre>

    <h3>BigInt</h3>

    <p>lips have no problems in evaluating factorial of thousand, and it's fast.</p>

    <pre><code class="language-scheme">
(define (! n) (reduce * (map 1+ (range n))))

(print (! 1000))
    </code></pre>

    <h3>List operations</h3>

    <pre><code class="language-scheme">
(cons 1 2)
(cons 1 (cons 2 nil))
(list 1 2 3 4)
'(1 2 3 4)

(let ((lst '(1 2 (3 4 5 6))))
   (print (car lst))
   (print (cadaddr lst)))
    </code></pre>

    <p>all functions that match this regex `c[ad]{1,5}r` are defined.</p>

    <h3>ALists</h3>

    <pre><code class="language-scheme">
(let ((l '((foo . "lorem") (bar "ipsum"))))
   (set-cdr! (assoc l 'foo) "hello")
   (set-cdr! (assoc l 'bar) "world")
   (print l))
    </code></pre>

    <h3>Flow constructs</h3>

    <pre><code class="language-scheme">
(let ((x 5))
    (while (> (-- x) 0) (print x)))
    </code></pre>

    <p>Operator <code>==</code> work as == in javascript but it should only be used on number or
      values that can be converted to numbers like string "10".</p>
    <p>To compare strings or any values use <code>eq?</code></p>

    <pre><code class="language-scheme">
(if (== "10" 10)
    (print "newer printed"))

(if (eq? "foo" "bar")
    (print "equal")
    (print "not equal"))

(let ((x 10))
  (if (and (> x 1) (< x 20))
      (begin
         (print "this is x > 1")
         (print "and x < 20"))))
    </code></pre>

    <h3>Eval</h3>

    <pre><code class="language-scheme">
(eval (read "(print \"hello\")"))
    </code></pre>

    <h3>Apply</h3>

    <p>Apply function the same as the one from javascript invoke a function with arguments taken from list</p>

    <pre><code class="language-scheme">
(let ((strings '("foo" "bar" "baz")))
   (print (apply concat strings)))
    </code></pre>

    <h3>Async code</h3>

    <pre><code class="language-scheme">
(eval (read))
    </code></pre>

    <p>
      then type S-Expression like <code>(print 10)</code>. If function return Promise
      the execution is paused and restored when Promise is resolved
    </p>


    <h3>Access JavaScript functions and objects</h3>

    <pre><code class="language-scheme">
((. window "alert") "hello")
((. console "log") "hello")
    </code></pre>

    <p>
      If object is not found in environment, then window object is tested for
      presense of the element.
    </p>

    <p>You can execute jQuery functions</p>

    <pre><code class="language-scheme">
(let* ((term ($ ".terminal")))
  ((.  term "css") "background" "red"))
    </code></pre>

    <p>function <code>$</code> is available because it's in window object.</p>

    <p>or operate on strings</p>

    <pre><code class="language-scheme">
((. "foo bar baz" "replace") /^[a-z]+/g "baz")

(let ((match (. "foo bar baz" "match")))
    (array->list (match /([a-z]+)/g)))
    </code></pre>

    <h3>String operations</h3>

    <pre><code class="language-scheme">
;; todo
    </code></pre>

    <h3>Mapping, filtering and reducing</h3>

    <pre><code class="language-scheme">
(map car (list
            (cons "a" 2)
            (cons "b" 3)))

(filter odd (list 1 2 3 4 5))

(filter (lambda (x)
          (== (% x 2) 0))
    (list 1 2 3 4 5))

(define (reverse list)
    (reduce (lambda (list x) (cons x list)) list nil))

(reverse '(1 2 3 4))

(define (sum . list) (reduce (lambda (a b) (+ a b)) list))
;; or
(define (sum . list) (reduce + list))

(print (sum 1 2 3 4 5))
    </code></pre>

    <h3>Auto resolving promises</h3>

    <pre><code class="language-scheme">
(let* ((res (fetch "https://terminal.jcubic.pl"))
       (text ((. res "text"))))
   (. ((. text "match") "&lt;title&gt;([^<]+)") 1))
    </code></pre>

    <h3>Currying</h3>

    <pre><code class="language-scheme">
(define (add a b) (+ a b))
(define add10 (curry add 10))
(print (add10 20))
    </code></pre>

    <h3>Working with arrays</h3>

    <p>
      You can modify array with <code>set!</code> function and to get the value of the
      array you can use <code>.</code> dot function.
    </p>

    <pre><code class="language-scheme">
(let ((arr (list->array '(1 2 3 4))))
   (set! (. x 1) 10)
   (print (array->list arr)))

(let* ((div ((. document "querySelectorAll") ".terminal .cmd-prompt"))
       (len (. div "length"))
       (i 0))
    (while (< i len)
       (print (. (. div i) "innerHTML"))
       (++ i)))
    </code></pre>

    <p>this equivalent of JavaScript code:</p>

    <pre><code class="language-javascript">
var div = document.querySelectorAll(".terminal .cmd-prompt");
var len = div.length;
var i = 0;
while (i < len) {
   console.log(div[i].innerHTML);
   ++i;
}
    </code></pre>

    <h3>Stdin and stdout</h3>

    <p>If you're using <strong><code>print</code></strong> function to display values or using
      <strong><code>read</code></strong> to get values from users, you can provide your own
      handlers in environment, jQuery Terminal based implementation look like this:</p>
    <p>By default stdout prints to console and stdin use browser <strong><code>prompt</code></strong> function.</p>

    <pre><code class="language-javascript">
var env = lips.env.inherit('name', {
    stdout: {
        write: function(...args) {
            args.forEach((arg) => {
                term.echo(arg, {keepWords: true});
            });
        }
    },
    stdin: {
        read: function() {
            return new Promise(function(resolve) {
                term.read('', function(command) {
                    resolve(command);
                });
            });
        }
    }
});
    </code></pre>

    <h3>Math and boolean operators (functions and macros)</h3>

    <pre>< > => <= 1+ 1- ++ -- + - * / % and or not</pre>
    <h3>Bit operation</h3>

    <pre>| &amp; ~ &lt;&lt; &gt;&gt;</pre>


    <h3>Extending LIPS</h3>

    <p>to create new function from JavaScript you can use:</p>

    <pre><code class="language-javascript">
env.set('greeter', function(user) {
   return "hello " + user;
});
    </code></pre>

    <p>then you can use it in LIPS:</p>

    <pre><code class="langauge-scheme">
(greeter "john")
    </code></pre>

    <p>
      To define a macro in javascript you can use Macro constructor that accept
      single function argument, that should return lisp code (instance of Pair).
    </p>

    <pre><code class="language-javascript">
var {Macro, Pair, Symbol, nil} = lips;

env.set('quote-car', new Macro('quote-car', function(code) {
    return Pair.fromArray([new Symbol('quote'), code.car.car]);
}));
    </code></pre>

    <p>and you can execute this macro in LIPS:</p>
    <pre><code class="language-scheme">
(quote-car (foo bar baz))
    </code></pre>
    <p>it will return first symbol and not execute it as function foo.</p>

    <p>you can also use eval here to execute code</p>
    <pre><code class="language-javascript">
env.set('async', new Macro('async', function(code, {dynamic_scope, error}) {
    var args = {error, env: this};
    if (dynamic_scope) {
        args.dynamic_scope = this;
    }
    return new Promise(function(resolve) {
        setTimeout(function() {
            resolve(evaluate(code.car, args));
        }, 0);
    });
}));
    </code></pre>

    <p>This function will invoke code in next iteration of event loop</p>
    <p>
      if you want to create macro like quasiquote, the returned code need to be wrapped with
      function quote
    </p>
    <p>
      When creating macros in JavaScript you can use helper <code>Pair.fromArray()</code>
      and <code>code.toArray()</code>.
    </p>
  </section>
  <footer>
    <p>Copyright (c) 2018-2020 <a href="https://jcubic.pl/me">Jakub T. Jankiewicz</a></p>
    <script>
    ((window.gitter = {}).chat = {}).options = {
      room: 'jcubic/lips'
    };
    </script>
    <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
    <!-- Matomo -->
    <script type="text/javascript">
      var _paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="//piwik.jcubic.pl/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '7']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Code -->
  </footer>

  <script src="https://unpkg.com/prismjs/prism.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-scheme.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-javascript.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-markup.min.js"></script>
  <link href="https://unpkg.com/prismjs/themes/prism-coy.css" rel="stylesheet"/>
</body>
</html>
